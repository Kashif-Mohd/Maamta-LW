using MySql.Data.MySqlClient;
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Globalization;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.DataVisualization.Charting;
using System.Drawing;

namespace maamta
{
    public partial class dashboardRandom : System.Web.UI.Page
    {
        string constr = ConfigurationManager.ConnectionStrings["LocalMySql"].ConnectionString;

        protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                Session["WebForm"] = "DashboardRandom";

                Session["RandTeamUname"] = null;
                Session["FirstEDate"] = null;
                Session["SecEDate"] = null;

                txtCalndrDate.Text = DateTime.Now.ToString("dd-MM-yyyy");
                txtCalndrDate1.Text = DateTime.Now.ToString("dd-MM-yyyy");

                txtCalndrDate.Attributes.Add("readonly", "readonly");
                txtCalndrDate1.Attributes.Add("readonly", "readonly");

                TotalEnrollment();
                ShowData();
                //ShowDataCRF3All();

                LoadChartSiteWise();
                LoadChartAllSite();
            }
        }


        public void showalert(string message)
        {
            string script = @"alert('" + message + "');";
            ScriptManager.RegisterStartupScript(this, this.GetType(), "Alert", script, true);
        }






        private void LoadChartSiteWise()
        {
            Chart1.ChartAreas["ChartArea1"].AxisX.MajorGrid.Enabled = false;
            Chart1.DataBindCrossTable(GetDataItem().DefaultView, "Site", "Year", "enrollment", "Label=enrollment");
            Chart1.DataBind();


            //Target Line:
            StripLine targetLine = new StripLine();
            targetLine.StripWidth = 0;
            targetLine.BorderColor = ColorTranslator.FromHtml("#55efc4");
            targetLine.BorderWidth = 2;
            targetLine.BorderDashStyle = ChartDashStyle.Solid;
            targetLine.IntervalOffset = 20; // In my case I am plotting percentages.
            targetLine.Text = "Target";
            targetLine.TextOrientation = TextOrientation.Horizontal;
            targetLine.ForeColor = targetLine.BorderColor;
            Chart1.ChartAreas[0].AxisY.StripLines.Add(targetLine);


            ////Poor Performance
            //StripLine poorLine = new StripLine();
            //poorLine.StripWidth = 0;
            //poorLine.BorderColor = ColorTranslator.FromHtml("#fab1a0");
            //poorLine.BorderWidth = 2;
            //poorLine.BorderDashStyle = ChartDashStyle.Dash;
            //poorLine.IntervalOffset = 12; // In my case I am plotting percentages.
            //poorLine.Text = "Poor";
            //poorLine.TextOrientation = TextOrientation.Horizontal;
            //poorLine.ForeColor = poorLine.BorderColor;
            //Chart1.ChartAreas[0].AxisY.StripLines.Add(poorLine);
        }





        private DataTable GetDataItem()
        {

            MySqlConnection con = new MySqlConnection(constr);
            con.Open();
            MySqlCommand cmd = new MySqlCommand("select Site, concat(Date_Format(str_to_date(lw_crf_3a_2, '%d-%m-%Y'),'%b'),'-',Date_Format(str_to_date(lw_crf_3a_2, '%d-%m-%Y'),'%y')) as Year,	 count(*) as enrollment  from view_crf3a group by Site,Year(str_to_date(lw_crf_3a_2, '%d-%m-%Y')),Month(str_to_date(lw_crf_3a_2, '%d-%m-%Y'))", con);
            {
                MySqlDataReader reader = cmd.ExecuteReader();
                DataTable dtData = new DataTable();
                dtData.Load(reader);
                return dtData;
                con.Close();
            }
            con.Close();
        }





        private void LoadChartAllSite()
        {
            try
            {
                string query = string.Format("select concat(Date_Format(str_to_date(lw_crf_3a_2, '%d-%m-%Y'),'%b'),'-',Date_Format(str_to_date(lw_crf_3a_2, '%d-%m-%Y'),'%y')) as Year, count(*) as enrollment	   from view_crf3a group by Year(str_to_date(lw_crf_3a_2, '%d-%m-%Y')),Month(str_to_date(lw_crf_3a_2, '%d-%m-%Y'))");
                DataTable dt = GetData(query);
                Chart2.DataSource = dt;
                Chart2.Series[0].XValueMember = "Year";
                Chart2.Series[0].YValueMembers = "enrollment";
                Chart2.Series[0].Label = "#VALY";
                Chart2.ChartAreas["ChartArea2"].AxisX.MajorGrid.Enabled = false;
                Chart2.DataBind();


                //Target Line:
                StripLine targetLine = new StripLine();
                targetLine.StripWidth = 0;
                targetLine.BorderColor = ColorTranslator.FromHtml("#55efc4");
                targetLine.BorderWidth = 3;
                targetLine.BorderDashStyle = ChartDashStyle.Dash;
                targetLine.IntervalOffset = 50; // In my case I am plotting percentages.
                targetLine.Text = "Target";
                targetLine.TextOrientation = TextOrientation.Horizontal;
                targetLine.ForeColor = targetLine.BorderColor;
                Chart2.ChartAreas[0].AxisY.StripLines.Add(targetLine);
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
          
        }




        //For Cumulative:
        private static DataTable GetData(string query)
        {
            string constr = ConfigurationManager.ConnectionStrings["LocalMySql"].ConnectionString;

            MySqlConnection con = new MySqlConnection(constr);
            {
                using (MySqlCommand cmd = new MySqlCommand(query))
                {
                    DataTable dt = new DataTable();
                    using (MySqlDataAdapter sda = new MySqlDataAdapter(query, con))
                    {
                        sda.Fill(dt);
                    }
                    return dt;
                }
            }
        }








        protected void btnSearch_Click(object sender, EventArgs e)
        {
            LoadChartSiteWise();
            LoadChartAllSite();

            if (DateTime.ParseExact(txtCalndrDate.Text, "dd-MM-yyyy", CultureInfo.InvariantCulture) > DateTime.ParseExact(txtCalndrDate1.Text, "dd-MM-yyyy", CultureInfo.InvariantCulture))
            {
                showalert("First Date should be Less or Equal than Second Date");
                txtCalndrDate.Focus();
            }
            else
            {
                ShowData();
                //ShowDataCRF3All();
            }
        }


        private void ShowData()
        {
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("select a.site,a.Tab_User as Tab_User,    (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Total,      (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.Q17_Vstatus='1' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Complete,      (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.Q17_Vstatus!='1' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Incomplete, (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and (x.lw_crf2_23='2' or x.Q20!='1' or x.Q19!='1') and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as NBdied_Stillbrth_Miscrge_TypePrg,              (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.lw_crf2_30>=23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.lw_crf2_30<23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less_23,             (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less23_and_Q26_Greater168,        (SELECT count(*) FROM view_crf2 as x where a.Tab_User =x.Tab_User and x.lw_crf2_30<23 and x.lw_crf2_26<=168 and (x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.lw_crf2_30<23 and x.lw_crf2_26<=168 and x.lw_crf2_44>=11 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less23_Age_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.lw_crf2_47=2 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.lw_crf2_47=1 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as consented_enrolledQ47      from view_crf2 as  a where (str_to_date(a.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   group by a.Tab_User union all  select '','Total',    (SELECT count(*) FROM view_crf2 as x  where (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Total,      (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='1' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Complete,      (SELECT count(*) FROM view_crf2 as x where  x.Q17_Vstatus!='1' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Incomplete, (SELECT count(*) FROM view_crf2 as x where  (x.lw_crf2_23='2' or x.Q20!='1' or x.Q19!='1') and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as NBdied_Stillbrth_Miscrge_TypePrg,              (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30>=23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less_23,             (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less23_and_Q26_Greater168,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26<=168 and (x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or x.lw_crf2_42=1 or x.lw_crf2_43=1) and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26<=168 and x.lw_crf2_44>=11 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less23_Age_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_47=2 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_47=1  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as consented_enrolledQ47 ", con);

                //32 Weeks Q32 added
                //   MySqlCommand cmd = new MySqlCommand("select a.Tab_User as Tab_User,    (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Total,      (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.Q17_Vstatus='1' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Complete,      (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.Q17_Vstatus!='1' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Incomplete, (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and (x.lw_crf2_23='2' or x.Q20!='1' or x.Q19!='1') and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as NBdied_Stillbrth_Miscrge_TypePrg,              (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.lw_crf2_30>=23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.lw_crf2_30<23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less_23,             (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less23_and_Q26_Greater168,        (SELECT count(*) FROM view_crf2 as x where a.Tab_User =x.Tab_User and x.lw_crf2_30<23 and x.lw_crf2_26<=168 and (x.lw_crf2_32<32 or x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.lw_crf2_30<23 and x.lw_crf2_26<=168 and x.lw_crf2_44>=11 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less23_Age_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.lw_crf2_47=2 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where a.Tab_User=x.Tab_User and x.lw_crf2_47=1 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as consented_enrolledQ47      from view_crf2 as  a where (str_to_date(a.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   group by a.Tab_User union all  select 'Total',    (SELECT count(*) FROM view_crf2 as x  where (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Total,      (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='1' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Complete,      (SELECT count(*) FROM view_crf2 as x where  x.Q17_Vstatus!='1' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Incomplete, (SELECT count(*) FROM view_crf2 as x where  (x.lw_crf2_23='2' or x.Q20!='1' or x.Q19!='1') and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as NBdied_Stillbrth_Miscrge_TypePrg,              (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30>=23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less_23,             (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less23_and_Q26_Greater168,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26<=168 and (x.lw_crf2_32<32 or x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or x.lw_crf2_42=1 or x.lw_crf2_43=1) and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26<=168 and x.lw_crf2_44>=11 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as MUAC_Less23_Age_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_47=2 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_47=1  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as consented_enrolledQ47 ", con);
                {
                    MySqlDataAdapter sda = new MySqlDataAdapter();
                    {
                        cmd.Connection = con;
                        cmd.CommandTimeout = 0;
                        sda.SelectCommand = cmd;
                        DataTable dt = new DataTable();
                        {
                            sda.Fill(dt);
                            GridView1.DataSource = dt;
                            GridView1.DataBind();
                            //  GridView1.Rows[GridView1.Rows.Count - 1].BackColor = System.Drawing.Color.FromName("#b2bec3");
                            con.Close();
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }



        // CRF-3a, 3b, 3c
        //private void ShowDataCRF3All()
        //{
        //    MySqlConnection con = new MySqlConnection(constr);
        //    try
        //    {
        //        con.Open();
        //        MySqlCommand cmd = new MySqlCommand("select a.Tab_User as Tab_User,    (SELECT count(*) FROM view_crf3a as x where a.Tab_User=x.Tab_User and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as TotalFilled_CRF3a,    (SELECT count(*) FROM view_crf3a as x where a.Tab_User=x.Tab_User and x.Q14_Vstatus!=1  and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Incomplete_CRF3a,    (SELECT count(*) FROM view_crf3a as x where a.Tab_User=x.Tab_User and x.Q14_Vstatus=1  and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Complete_CRF3a,    (SELECT count(*) FROM view_crf3b as x where a.Tab_User=x.Tab_User and (str_to_date(x.lw_crf3b_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as CRF3b_Filled,    (SELECT count(*) FROM view_crf3c as x where a.Tab_User=x.Tab_User  and (str_to_date(x.lw_crf3c_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as CRF3c_Filled  from   view_crf2 as a where (str_to_date(a.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  group by a.Tab_User union all  select 'Total',    (SELECT count(*) FROM view_crf3a as x where (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as TotalFilled_CRF3a,    (SELECT count(*) FROM view_crf3a as x where x.Q14_Vstatus!=1 and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Incomplete_CRF3a,    (SELECT count(*) FROM view_crf3a as x where x.Q14_Vstatus=1  and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Complete_CRF3a,    (SELECT count(*) FROM view_crf3b as x where  (str_to_date(x.lw_crf3b_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as CRF3b_Filled,    (SELECT count(*) FROM view_crf3c as x  where  (str_to_date(x.lw_crf3c_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as CRF3c_Filled  ", con);
        //        {
        //            MySqlDataAdapter sda = new MySqlDataAdapter();
        //            {
        //                cmd.Connection = con;
        //                cmd.CommandTimeout = 0;
        //                sda.SelectCommand = cmd;
        //                DataTable dt = new DataTable();
        //                {
        //                    sda.Fill(dt);
        //                    GridView7.DataSource = dt;
        //                    GridView7.DataBind();
        //                    con.Close();
        //                }
        //            }
        //        }
        //    }
        //    catch (Exception ex)
        //    {
        //        Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
        //    }
        //    finally
        //    {
        //        con.Close();
        //    }
        //}



        protected void btnExport_Click(object sender, EventArgs e)
        {
            ShowData();
            if (GridView1.Rows.Count != 0)
            {
                ExcelExportReport();
            }
        }

        protected void btnExport1_Click(object sender, EventArgs e)
        {
            ShowData();
            if (GridView1.Rows.Count != 0)
            {
                ExcelExportARM();
            }
        }



        public void ExcelExport_ARM_Message()
        {
            GridView2.Caption = "<h2> RANDOMIZATION ARM     <h3/>  ARM: A";
            GridView3.Caption = "<h3>  ARM: B";
            GridView4.Caption = "<h3>  ARM: C";
        }


        public override void VerifyRenderingInServerForm(Control control)
        {
            //base.VerifyRenderingInServerForm(control);
        }



        private void Export_ARM_A()
        {
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                //Date Wise
                con.Open();
                MySqlCommand cmd = new MySqlCommand("select c.lw_crf_1_11 as Site,(SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 0 and  x.lw_crf2_26 < 24)) as 'Day 0 (less than 24 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 24 and  x.lw_crf2_26 < 48)) as 'Day 1 (less than 48 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 48 and  x.lw_crf2_26 < 72)) as 'Day 2 (less than 72 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 72 and  x.lw_crf2_26 < 96)) as 'Day 3 (less than 96 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 96 and  x.lw_crf2_26 < 120)) as 'Day 4 (less than 120 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 120 and  x.lw_crf2_26 < 144)) as 'Day 5 (less than 144 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 144 and  x.lw_crf2_26 < 168)) as 'Day 6 (less than 168 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11) as 'Sum Record'   from form_crf_2 as a left join pw as b on a.assis_id=b.id left join dss_address as c on c.dss_id=b.dss_id where c.lw_crf_1_11 is not null  group by c.lw_crf_1_11 union all select 'Total',(SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 0 and  x.lw_crf2_26 < 24)) as 'Day 0 (less than 24 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 24 and  x.lw_crf2_26 < 48)) as 'Day 1 (less than 48 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 48 and  x.lw_crf2_26 < 72)) as 'Day 2 (less than 72 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 72 and  x.lw_crf2_26 < 96)) as 'Day 3 (less than 96 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 96 and  x.lw_crf2_26 < 120)) as 'Day 4 (less than 120 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 120 and  x.lw_crf2_26 < 144)) as 'Day 5 (less than 144 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 144 and  x.lw_crf2_26 < 168)) as 'Day 6 (less than 168 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as 'Sum Record'", con);

                //  02-Jan-2019
                // MySqlCommand cmd = new MySqlCommand("select a.site as Site,(SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 0 and  x.lw_crf2_26 < 24)) as 'Day 0 (less than 24 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 24 and  x.lw_crf2_26 < 48)) as 'Day 1 (less than 48 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 48 and  x.lw_crf2_26 < 72)) as 'Day 2 (less than 72 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 72 and  x.lw_crf2_26 < 96)) as 'Day 3 (less than 96 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 96 and  x.lw_crf2_26 < 120)) as 'Day 4 (less than 120 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 120 and  x.lw_crf2_26 < 144)) as 'Day 5 (less than 144 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 144 and  x.lw_crf2_26 < 168)) as 'Day 6 (less than 168 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site) as 'Sum Record'   from view_crf2 as  a  group by a.site  union all  select 'Total', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id  and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 0 and  x.lw_crf2_26 < 24)) as 'Day 0 (less than 24 Hrs)',        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 24 and  x.lw_crf2_26 < 48)) as 'Day 1 (less than 48 Hrs)',        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 48 and  x.lw_crf2_26 < 72)) as 'Day 2 (less than 72 Hrs)' ,        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 72 and  x.lw_crf2_26 < 96)) as 'Day 3 (less than 96 Hrs)' ,        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 96 and  x.lw_crf2_26 < 120)) as 'Day 4 (less than 120 Hrs)',        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 120 and  x.lw_crf2_26 < 144)) as 'Day 5 (less than 144 Hrs)' ,        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 144 and  x.lw_crf2_26 < 168)) as 'Day 6 (less than 168 Hrs)',        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='a'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'Sum Record'", con);

                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView2.DataSource = dt;
                        GridView2.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }


        private void Export_ARM_B()
        {
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                //Date Wise
                con.Open();
                MySqlCommand cmd = new MySqlCommand("select c.lw_crf_1_11 as Site,(SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 0 and  x.lw_crf2_26 < 24)) as 'Day 0 (less than 24 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 24 and  x.lw_crf2_26 < 48)) as 'Day 1 (less than 48 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 48 and  x.lw_crf2_26 < 72)) as 'Day 2 (less than 72 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 72 and  x.lw_crf2_26 < 96)) as 'Day 3 (less than 96 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 96 and  x.lw_crf2_26 < 120)) as 'Day 4 (less than 120 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 120 and  x.lw_crf2_26 < 144)) as 'Day 5 (less than 144 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 144 and  x.lw_crf2_26 < 168)) as 'Day 6 (less than 168 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11) as 'Sum Record'   from form_crf_2 as a left join pw as b on a.assis_id=b.id left join dss_address as c on c.dss_id=b.dss_id where c.lw_crf_1_11 is not null  group by c.lw_crf_1_11 union all select 'Total',(SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 0 and  x.lw_crf2_26 < 24)) as 'Day 0 (less than 24 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 24 and  x.lw_crf2_26 < 48)) as 'Day 1 (less than 48 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 48 and  x.lw_crf2_26 < 72)) as 'Day 2 (less than 72 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 72 and  x.lw_crf2_26 < 96)) as 'Day 3 (less than 96 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 96 and  x.lw_crf2_26 < 120)) as 'Day 4 (less than 120 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 120 and  x.lw_crf2_26 < 144)) as 'Day 5 (less than 144 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 144 and  x.lw_crf2_26 < 168)) as 'Day 6 (less than 168 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as 'Sum Record'", con);

                //  02-Jan-2019
                //MySqlCommand cmd = new MySqlCommand("select a.site as Site,(SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 0 and  x.lw_crf2_26 < 24)) as 'Day 0 (less than 24 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 24 and  x.lw_crf2_26 < 48)) as 'Day 1 (less than 48 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 48 and  x.lw_crf2_26 < 72)) as 'Day 2 (less than 72 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 72 and  x.lw_crf2_26 < 96)) as 'Day 3 (less than 96 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 96 and  x.lw_crf2_26 < 120)) as 'Day 4 (less than 120 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 120 and  x.lw_crf2_26 < 144)) as 'Day 5 (less than 144 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 144 and  x.lw_crf2_26 < 168)) as 'Day 6 (less than 168 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site) as 'Sum Record'   from view_crf2 as  a  group by a.site  union all  select 'Total', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id  and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 0 and  x.lw_crf2_26 < 24)) as 'Day 0 (less than 24 Hrs)',        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 24 and  x.lw_crf2_26 < 48)) as 'Day 1 (less than 48 Hrs)',        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 48 and  x.lw_crf2_26 < 72)) as 'Day 2 (less than 72 Hrs)' ,        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 72 and  x.lw_crf2_26 < 96)) as 'Day 3 (less than 96 Hrs)' ,        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 96 and  x.lw_crf2_26 < 120)) as 'Day 4 (less than 120 Hrs)',        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 120 and  x.lw_crf2_26 < 144)) as 'Day 5 (less than 144 Hrs)' ,        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 144 and  x.lw_crf2_26 < 168)) as 'Day 6 (less than 168 Hrs)',        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='b'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'Sum Record'", con);

                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView3.DataSource = dt;
                        GridView3.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }


        private void Export_ARM_C()
        {
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                //Date Wise
                con.Open();
                MySqlCommand cmd = new MySqlCommand("select c.lw_crf_1_11 as Site,(SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 0 and  x.lw_crf2_26 < 24)) as 'Day 0 (less than 24 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 24 and  x.lw_crf2_26 < 48)) as 'Day 1 (less than 48 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 48 and  x.lw_crf2_26 < 72)) as 'Day 2 (less than 72 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 72 and  x.lw_crf2_26 < 96)) as 'Day 3 (less than 96 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 96 and  x.lw_crf2_26 < 120)) as 'Day 4 (less than 120 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 120 and  x.lw_crf2_26 < 144)) as 'Day 5 (less than 144 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11 and (x.lw_crf2_26 >= 144 and  x.lw_crf2_26 < 168)) as 'Day 6 (less than 168 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and c.lw_crf_1_11=j.lw_crf_1_11) as 'Sum Record'   from form_crf_2 as a left join pw as b on a.assis_id=b.id left join dss_address as c on c.dss_id=b.dss_id where c.lw_crf_1_11 is not null  group by c.lw_crf_1_11 union all select 'Total',(SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 0 and  x.lw_crf2_26 < 24)) as 'Day 0 (less than 24 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 24 and  x.lw_crf2_26 < 48)) as 'Day 1 (less than 48 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 48 and  x.lw_crf2_26 < 72)) as 'Day 2 (less than 72 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 72 and  x.lw_crf2_26 < 96)) as 'Day 3 (less than 96 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 96 and  x.lw_crf2_26 < 120)) as 'Day 4 (less than 120 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 120 and  x.lw_crf2_26 < 144)) as 'Day 5 (less than 144 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) and (x.lw_crf2_26 >= 144 and  x.lw_crf2_26 < 168)) as 'Day 6 (less than 168 Hrs)', (SELECT count(*) FROM form_crf_2 as x inner join form_crf_3a as y on x.assis_id=y.assis_id and x.team_id=y.team_id 		left join pw as i on x.assis_id=i.id left join dss_address as j on j.dss_id=i.dss_id where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as 'Sum Record'", con);

                //  02-Jan-2019
                //MySqlCommand cmd = new MySqlCommand("select a.site as Site,(SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 0 and  x.lw_crf2_26 < 24)) as 'Day 0 (less than 24 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 24 and  x.lw_crf2_26 < 48)) as 'Day 1 (less than 48 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 48 and  x.lw_crf2_26 < 72)) as 'Day 2 (less than 72 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 72 and  x.lw_crf2_26 < 96)) as 'Day 3 (less than 96 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 96 and  x.lw_crf2_26 < 120)) as 'Day 4 (less than 120 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 120 and  x.lw_crf2_26 < 144)) as 'Day 5 (less than 144 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site and (x.lw_crf2_26 >= 144 and  x.lw_crf2_26 < 168)) as 'Day 6 (less than 168 Hrs)', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and a.site=x.site) as 'Sum Record'   from view_crf2 as  a  group by a.site  union all  select 'Total', (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id  and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 0 and  x.lw_crf2_26 < 24)) as 'Day 0 (less than 24 Hrs)',        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 24 and  x.lw_crf2_26 < 48)) as 'Day 1 (less than 48 Hrs)',        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 48 and  x.lw_crf2_26 < 72)) as 'Day 2 (less than 72 Hrs)' ,        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 72 and  x.lw_crf2_26 < 96)) as 'Day 3 (less than 96 Hrs)' ,        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 96 and  x.lw_crf2_26 < 120)) as 'Day 4 (less than 120 Hrs)',        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 120 and  x.lw_crf2_26 < 144)) as 'Day 5 (less than 144 Hrs)' ,        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (x.lw_crf2_26 >= 144 and  x.lw_crf2_26 < 168)) as 'Day 6 (less than 168 Hrs)',        (SELECT count(*) FROM view_crf2 as x inner join view_crf3a as y on x.assis_id=y.assis_id and x.Tab_User=y.Tab_User where  y.lw_crf_3a_19='c'  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  and (str_to_date(y.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'Sum Record'", con);

                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView4.DataSource = dt;
                        GridView4.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }



        // ARM Report 
        public void ExcelExportARM()
        {
            try
            {
                Response.Clear();
                Response.AddHeader("content-disposition", "attachment;filename=ARM Report (" + DateTime.Today.ToString("dd-MM-yyyy") + ").xls");
                Response.Charset = "";

                Response.ContentType = "application/vnd.xls";
                System.IO.StringWriter stringWrite = new System.IO.StringWriter();
                System.Web.UI.HtmlTextWriter htmlWrite = new HtmlTextWriter(stringWrite);
                GridView2.AllowPaging = false;
                GridView3.AllowPaging = false;
                GridView4.AllowPaging = false;
                ExcelExport_ARM_Message();
                GridView2.CaptionAlign = TableCaptionAlign.Top;
                GridView3.CaptionAlign = TableCaptionAlign.Top;
                GridView4.CaptionAlign = TableCaptionAlign.Top;

                Export_ARM_A();
                Export_ARM_B();
                Export_ARM_C();

                //ARM: A
                for (int i = 0; i < GridView2.HeaderRow.Cells.Count; i++)
                {
                    GridView2.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView2.HeaderRow.Cells[i].Style.Add("height", "30px");
                    GridView2.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView2.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView2.Rows[GridView2.Rows.Count - 1].Style.Add("font-size", "15px");
                GridView2.Rows[GridView2.Rows.Count - 1].Font.Bold = true;

                //ARM: B
                for (int i = 0; i < GridView3.HeaderRow.Cells.Count; i++)
                {
                    GridView3.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView3.HeaderRow.Cells[i].Style.Add("height", "30px");
                    GridView3.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView3.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView3.Rows[GridView3.Rows.Count - 1].Style.Add("font-size", "15px");
                GridView3.Rows[GridView3.Rows.Count - 1].Font.Bold = true;

                //ARM: C
                for (int i = 0; i < GridView4.HeaderRow.Cells.Count; i++)
                {
                    GridView4.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView4.HeaderRow.Cells[i].Style.Add("height", "30px");
                    GridView4.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView4.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView4.Rows[GridView4.Rows.Count - 1].Style.Add("font-size", "15px");
                GridView4.Rows[GridView4.Rows.Count - 1].Font.Bold = true;


                GridView2.RenderControl(htmlWrite);
                GridView3.RenderControl(htmlWrite);
                GridView4.RenderControl(htmlWrite);

                Response.Write(stringWrite.ToString());
                Response.End();

            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert(" + ex.Message + ")</script>");

            }
        }






        public void ExcelExportMessage_Report()
        {
            GridView5.Caption = "<h2/> MAAMTA LW trial <br/>   <h4> Lactating Women (LW) screened for eligibility after live birth - CRF2<br/>Date from '" + txtCalndrDate.Text + "' To '" + txtCalndrDate1.Text + "'";
            GridView6.Caption = "<br/><br/>    <h4>Lactating Women (LW) screened for eligibility after live birth - CRF2 <br/>CUMULATIVE REPORT";
            GridView8.Caption = "<br/><br/><br/><br/>    <h4>Current Randomization and enrollments<br/>Date from '" + txtCalndrDate.Text + "' To '" + txtCalndrDate1.Text + "'";
            GridView9.Caption = "<br/><br/>    <h4>Cumulative Randomization and enrollments<br/>CUMULATIVE REPORT";

        }

        //CRF-2 Report:
        private void ExportReportdata()
        {
            //Date Wise
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("select 'AG',     (SELECT count(*) FROM view_crf2 as x where x.site='AG' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x where x.site='AG' and  x.Q17_Vstatus='7'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as LW_died,        (SELECT count(*) FROM view_crf2 as x where x.site='AG' and x.lw_crf2_23='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x where x.site='AG' and x.Q20='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x where x.site='AG' and x.Q20='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Miscarriage,        (SELECT count(*) FROM view_crf2 as x where x.site='AG' and x.Q19!='1'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x where x.site='AG' and x.Q17_Vstatus='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x where x.site='AG' and x.Q17_Vstatus='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x where x.site='AG' and x.Q17_Vstatus='5'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x where x.site='AG' and x.Q17_Vstatus='6'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Adopted,        (SELECT count(*) FROM view_crf2 as x where x.site='AG' and x.Q17_Vstatus='4'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x where x.site='AG' and  x.lw_crf2_30!=''  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Complete,        (SELECT count(*) FROM view_crf2 as x where x.site='AG' and x.lw_crf2_30>=23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where x.site='AG' and x.lw_crf2_30<23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,  					            	     (SELECT count(*) FROM view_crf2 as x where x.site='AG' and  x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_and_AnyExclusion,     		(SELECT count(*) FROM view_crf2 as x where x.site='AG' and x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34>=1500 && x.lw_crf2_36=1 && x.lw_crf2_37=1 && x.lw_crf2_38_a=2 && x.lw_crf2_38_b=2 && x.lw_crf2_39=2 && x.lw_crf2_40=1 && x.lw_crf2_41_a=2 && x.lw_crf2_41_b=2 && x.lw_crf2_41_c=2 && x.lw_crf2_41_d=2 && x.lw_crf2_41_e=2 && x.lw_crf2_41_f=2 &&  x.lw_crf2_42=2 && x.lw_crf2_43=2)	  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_noExclusion,				     (SELECT count(*) FROM view_crf2 as x where x.site='AG' and  x.lw_crf2_30<23 and x.lw_crf2_26<168 and (x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where x.site='AG' and x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x where x.site='AG' and x.lw_crf2_47=2  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where x.site='AG' and x.lw_crf2_47=1  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x where x.site='AG' and   (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Total_RandomFilled_3a union all select 'BH',     (SELECT count(*) FROM view_crf2 as x where x.site='BH' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x where x.site='BH' and  x.Q17_Vstatus='7'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as LW_died,        (SELECT count(*) FROM view_crf2 as x where x.site='BH' and x.lw_crf2_23='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x where x.site='BH' and x.Q20='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x where x.site='BH' and x.Q20='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MiscarriBHe,        (SELECT count(*) FROM view_crf2 as x where x.site='BH' and x.Q19!='1'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x where x.site='BH' and x.Q17_Vstatus='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x where x.site='BH' and x.Q17_Vstatus='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x where x.site='BH' and x.Q17_Vstatus='5'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x where x.site='BH' and x.Q17_Vstatus='6'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Adopted,        (SELECT count(*) FROM view_crf2 as x where x.site='BH' and x.Q17_Vstatus='4'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x where x.site='BH' and  x.lw_crf2_30!=''  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Complete,        (SELECT count(*) FROM view_crf2 as x where x.site='BH' and x.lw_crf2_30>=23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where x.site='BH' and x.lw_crf2_30<23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,  					            	     (SELECT count(*) FROM view_crf2 as x where x.site='BH' and  x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_BHe_Greater_7days_and_AnyExclusion,     		(SELECT count(*) FROM view_crf2 as x where x.site='BH' and x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34>=1500 && x.lw_crf2_36=1 && x.lw_crf2_37=1 && x.lw_crf2_38_a=2 && x.lw_crf2_38_b=2 && x.lw_crf2_39=2 && x.lw_crf2_40=1 && x.lw_crf2_41_a=2 && x.lw_crf2_41_b=2 && x.lw_crf2_41_c=2 && x.lw_crf2_41_d=2 && x.lw_crf2_41_e=2 && x.lw_crf2_41_f=2 &&  x.lw_crf2_42=2 && x.lw_crf2_43=2)	  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_noExclusion,				     (SELECT count(*) FROM view_crf2 as x where x.site='BH' and  x.lw_crf2_30<23 and x.lw_crf2_26<168 and (x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_BHe_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where x.site='BH' and x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_BHe_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x where x.site='BH' and x.lw_crf2_47=2  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where x.site='BH' and x.lw_crf2_47=1  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x where x.site='BH' and   (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Total_RandomFilled_3a union all select 'RG',     (SELECT count(*) FROM view_crf2 as x where x.site='RG' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x where x.site='RG' and  x.Q17_Vstatus='7'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as LW_died,        (SELECT count(*) FROM view_crf2 as x where x.site='RG' and x.lw_crf2_23='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x where x.site='RG' and x.Q20='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x where x.site='RG' and x.Q20='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MiscarriRGe,        (SELECT count(*) FROM view_crf2 as x where x.site='RG' and x.Q19!='1'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x where x.site='RG' and x.Q17_Vstatus='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x where x.site='RG' and x.Q17_Vstatus='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x where x.site='RG' and x.Q17_Vstatus='5'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x where x.site='RG' and x.Q17_Vstatus='6'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Adopted,        (SELECT count(*) FROM view_crf2 as x where x.site='RG' and x.Q17_Vstatus='4'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x where x.site='RG' and  x.lw_crf2_30!=''  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Complete,        (SELECT count(*) FROM view_crf2 as x where x.site='RG' and x.lw_crf2_30>=23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where x.site='RG' and x.lw_crf2_30<23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,  					            	     (SELECT count(*) FROM view_crf2 as x where x.site='RG' and  x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_RGe_Greater_7days_and_AnyExclusion,     		(SELECT count(*) FROM view_crf2 as x where x.site='RG' and x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34>=1500 && x.lw_crf2_36=1 && x.lw_crf2_37=1 && x.lw_crf2_38_a=2 && x.lw_crf2_38_b=2 && x.lw_crf2_39=2 && x.lw_crf2_40=1 && x.lw_crf2_41_a=2 && x.lw_crf2_41_b=2 && x.lw_crf2_41_c=2 && x.lw_crf2_41_d=2 && x.lw_crf2_41_e=2 && x.lw_crf2_41_f=2 &&  x.lw_crf2_42=2 && x.lw_crf2_43=2)	  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_noExclusion,				     (SELECT count(*) FROM view_crf2 as x where x.site='RG' and  x.lw_crf2_30<23 and x.lw_crf2_26<168 and (x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_RGe_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where x.site='RG' and x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_RGe_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x where x.site='RG' and x.lw_crf2_47=2  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where x.site='RG' and x.lw_crf2_47=1  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x where x.site='RG' and   (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Total_RandomFilled_3a union all select 'Total',     (SELECT count(*) FROM view_crf2 as x where (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x where  x.Q17_Vstatus='7'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as LW_died,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_23='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x where x.Q20='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x where x.Q20='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Miscarriage,        (SELECT count(*) FROM view_crf2 as x where x.Q19!='1'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='5'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='6'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Adopted,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='4'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30!=''  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Complete,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30>=23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,  					            	     (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_and_AnyExclusion,     		(SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34>=1500 && x.lw_crf2_36=1 && x.lw_crf2_37=1 && x.lw_crf2_38_a=2 && x.lw_crf2_38_b=2 && x.lw_crf2_39=2 && x.lw_crf2_40=1 && x.lw_crf2_41_a=2 && x.lw_crf2_41_b=2 && x.lw_crf2_41_c=2 && x.lw_crf2_41_d=2 && x.lw_crf2_41_e=2 && x.lw_crf2_41_f=2 &&  x.lw_crf2_42=2 && x.lw_crf2_43=2)	  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_noExclusion,				     (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and x.lw_crf2_26<168 and (x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_47=2  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_47=1  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x where   (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Total_RandomFilled_3a", con);

                
                // Before 12-May-2019
                // MySqlCommand cmd = new MySqlCommand("select a.site as Site,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='7' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as LW_died,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_23='2' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q20='2' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q20='3' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Miscarriage,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q19!='1' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='3' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='2' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='5' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='6' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Adopted,               (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='4' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30!='' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Complete,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30>=23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,         		   	   (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1) and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_and_AnyExclusion,   		  (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26>=168 			and ( x.lw_crf2_34>=1500 && x.lw_crf2_36=1 && x.lw_crf2_37=1 && x.lw_crf2_38_a=2 && x.lw_crf2_38_b=2 && x.lw_crf2_39=2 && x.lw_crf2_40=1 && x.lw_crf2_41_a=2 && x.lw_crf2_41_b=2 && x.lw_crf2_41_c=2 && x.lw_crf2_41_d=2 && x.lw_crf2_41_e=2 && x.lw_crf2_41_f=2 &&  x.lw_crf2_42=2 && x.lw_crf2_43=2)		 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_noExclusion,				     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26<168 and (x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1) and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_noExclusion,   			  (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_47=2 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_47=1   and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x where a.site=x.site      and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Total_RandomFilled_3a  from view_crf2 as  a  group by a.site union all select 'Total',     (SELECT count(*) FROM view_crf2 as x where (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x where  x.Q17_Vstatus='7'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as LW_died,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_23='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x where x.Q20='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x where x.Q20='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Miscarriage,        (SELECT count(*) FROM view_crf2 as x where x.Q19!='1'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='5'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='6'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Adopted,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='4'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30!=''  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Complete,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30>=23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,  					            	     (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_and_AnyExclusion,     		(SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34>=1500 && x.lw_crf2_36=1 && x.lw_crf2_37=1 && x.lw_crf2_38_a=2 && x.lw_crf2_38_b=2 && x.lw_crf2_39=2 && x.lw_crf2_40=1 && x.lw_crf2_41_a=2 && x.lw_crf2_41_b=2 && x.lw_crf2_41_c=2 && x.lw_crf2_41_d=2 && x.lw_crf2_41_e=2 && x.lw_crf2_41_f=2 &&  x.lw_crf2_42=2 && x.lw_crf2_43=2)	  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Greater_7days_noExclusion,				     (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and x.lw_crf2_26<168 and (x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_47=2  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_47=1  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x where   (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Total_RandomFilled_3a", con);
                // before (15-Oct-2018)
                //  MySqlCommand cmd = new MySqlCommand("select a.site as Site,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='7' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as LW_died,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_23='2' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q20='2' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q20='3' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Miscarriage,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q19!='1' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='3' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='2' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='5' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='6' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Adopted,               (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='4' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30!='' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Complete,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30>=23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,             (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_and_Q26_Greater168,   			   (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (x.lw_crf2_32<32 or x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1) and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26>=168 and x.lw_crf2_44>=11 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_0to6_noExclusion,				     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26<168 and (x.lw_crf2_32<32 or x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1) and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_noExclusion,   			  (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_47=2 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_47=1   and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x where a.site=x.site      and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Total_RandomFilled_3a  from view_crf2 as  a  group by a.site  union all select 'Total',     (SELECT count(*) FROM view_crf2 as x where (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x where  x.Q17_Vstatus='7'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as LW_died,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_23='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x where x.Q20='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x where x.Q20='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Miscarriage,        (SELECT count(*) FROM view_crf2 as x where x.Q19!='1'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='5'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='6'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Adopted,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='4'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30!=''  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Complete,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30>=23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,             (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and x.lw_crf2_26>=168  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_and_Q26_Greater168,   	     (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (x.lw_crf2_32<32 or x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26>=168 and x.lw_crf2_44>=11  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_noExclusion,				     (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and x.lw_crf2_26<168 and (x.lw_crf2_32<32 or x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_47=2  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_47=1  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x where   (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Total_RandomFilled_3a", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView5.DataSource = dt;
                        GridView5.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }

        private void ExportReportdata_WithOutDate()
        {
            //Cumulative
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("select 'AG',     (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and   x.Q17_Vstatus='7'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as LW_died,        (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  x.lw_crf2_23='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  x.Q20='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  x.Q20='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Miscarriage,        (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  x.Q19!='1'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  x.Q17_Vstatus='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  x.Q17_Vstatus='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  x.Q17_Vstatus='5'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  x.Q17_Vstatus='6'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))    ) as Adopted,        (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  x.Q17_Vstatus='4'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and   x.lw_crf2_30!=''  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as Complete,        (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  x.lw_crf2_30>=23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  x.lw_crf2_30<23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,      (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and   x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34>=1500 && x.lw_crf2_36=1 && x.lw_crf2_37=1 && x.lw_crf2_38_a=2 && x.lw_crf2_38_b=2 && x.lw_crf2_39=2 && x.lw_crf2_40=1 && x.lw_crf2_41_a=2 && x.lw_crf2_41_b=2 && x.lw_crf2_41_c=2 && x.lw_crf2_41_d=2 && x.lw_crf2_41_e=2 && x.lw_crf2_41_f=2 &&  x.lw_crf2_42=2 && x.lw_crf2_43=2) and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_noExclusion,     (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and   x.lw_crf2_30<23 and x.lw_crf2_26<168 and ( x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  x.lw_crf2_47=2  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x  where x.site ='AG' and  x.lw_crf2_47=1  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x  where x.site ='AG' and    (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Total_RandomFilled_3a union all  select 'BH',     (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and   x.Q17_Vstatus='7'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as LW_died,        (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  x.lw_crf2_23='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  x.Q20='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  x.Q20='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Miscarriage,        (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  x.Q19!='1'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  x.Q17_Vstatus='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  x.Q17_Vstatus='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  x.Q17_Vstatus='5'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  x.Q17_Vstatus='6'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))    ) as Adopted,        (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  x.Q17_Vstatus='4'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and   x.lw_crf2_30!=''  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as Complete,        (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  x.lw_crf2_30>=23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  x.lw_crf2_30<23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,      (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and   x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34>=1500 && x.lw_crf2_36=1 && x.lw_crf2_37=1 && x.lw_crf2_38_a=2 && x.lw_crf2_38_b=2 && x.lw_crf2_39=2 && x.lw_crf2_40=1 && x.lw_crf2_41_a=2 && x.lw_crf2_41_b=2 && x.lw_crf2_41_c=2 && x.lw_crf2_41_d=2 && x.lw_crf2_41_e=2 && x.lw_crf2_41_f=2 &&  x.lw_crf2_42=2 && x.lw_crf2_43=2) and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_noExclusion,     (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and   x.lw_crf2_30<23 and x.lw_crf2_26<168 and ( x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  x.lw_crf2_47=2  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x  where x.site ='BH' and  x.lw_crf2_47=1  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x  where x.site ='BH' and    (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Total_RandomFilled_3a union all  select 'RG',     (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and   x.Q17_Vstatus='7'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as LW_died,        (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  x.lw_crf2_23='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  x.Q20='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  x.Q20='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Miscarriage,        (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  x.Q19!='1'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  x.Q17_Vstatus='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  x.Q17_Vstatus='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  x.Q17_Vstatus='5'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  x.Q17_Vstatus='6'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))    ) as Adopted,        (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  x.Q17_Vstatus='4'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and   x.lw_crf2_30!=''  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as Complete,        (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  x.lw_crf2_30>=23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  x.lw_crf2_30<23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,      (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and   x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34>=1500 && x.lw_crf2_36=1 && x.lw_crf2_37=1 && x.lw_crf2_38_a=2 && x.lw_crf2_38_b=2 && x.lw_crf2_39=2 && x.lw_crf2_40=1 && x.lw_crf2_41_a=2 && x.lw_crf2_41_b=2 && x.lw_crf2_41_c=2 && x.lw_crf2_41_d=2 && x.lw_crf2_41_e=2 && x.lw_crf2_41_f=2 &&  x.lw_crf2_42=2 && x.lw_crf2_43=2) and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_noExclusion,     (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and   x.lw_crf2_30<23 and x.lw_crf2_26<168 and ( x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  x.lw_crf2_47=2  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x  where x.site ='RG' and  x.lw_crf2_47=1  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x  where x.site ='RG' and    (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Total_RandomFilled_3a union all  select 'Total',     (SELECT count(*) FROM view_crf2 as x where (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x where  x.Q17_Vstatus='7'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as LW_died,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_23='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x where x.Q20='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x where x.Q20='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Miscarriage,        (SELECT count(*) FROM view_crf2 as x where x.Q19!='1'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='5'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='6'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))    ) as Adopted,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='4'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30!=''  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as Complete,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30>=23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,      (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34>=1500 && x.lw_crf2_36=1 && x.lw_crf2_37=1 && x.lw_crf2_38_a=2 && x.lw_crf2_38_b=2 && x.lw_crf2_39=2 && x.lw_crf2_40=1 && x.lw_crf2_41_a=2 && x.lw_crf2_41_b=2 && x.lw_crf2_41_c=2 && x.lw_crf2_41_d=2 && x.lw_crf2_41_e=2 && x.lw_crf2_41_f=2 &&  x.lw_crf2_42=2 && x.lw_crf2_43=2) and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_noExclusion,     (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and x.lw_crf2_26<168 and ( x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_47=2  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_47=1  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x where   (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Total_RandomFilled_3a", con);

                // Before 12-May-2019
               // MySqlCommand cmd = new MySqlCommand("Select a.site as Site,   (SELECT count(*) FROM view_crf2 as x where a.site=x.site and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='7' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as LW_died,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_23='2' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q20='2' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q20='3' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Miscarriage,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q19!='1' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='3' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='2' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='5' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='6' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Adopted,               (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='4' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30!='' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Complete,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30>=23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,                   			 (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1) and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34>=1500 && x.lw_crf2_36=1 && x.lw_crf2_37=1 && x.lw_crf2_38_a=2 && x.lw_crf2_38_b=2 && x.lw_crf2_39=2 && x.lw_crf2_40=1 && x.lw_crf2_41_a=2 && x.lw_crf2_41_b=2 && x.lw_crf2_41_c=2 && x.lw_crf2_41_d=2 && x.lw_crf2_41_e=2 && x.lw_crf2_41_f=2 &&  x.lw_crf2_42=2 && x.lw_crf2_43=2)	 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_noExclusion,						   (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26<168 and ( x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1) and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_noExclusion,	     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_47=2 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_47=1   and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x where a.site=x.site      and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Total_RandomFilled_3a  from view_crf2 as  a  group by a.site    union all select 'Total',     (SELECT count(*) FROM view_crf2 as x where (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x where  x.Q17_Vstatus='7'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as LW_died,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_23='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x where x.Q20='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x where x.Q20='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Miscarriage,        (SELECT count(*) FROM view_crf2 as x where x.Q19!='1'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='5'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='6'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))    ) as Adopted,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='4'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30!=''  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as Complete,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30>=23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,      		(SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26>=168 and ( x.lw_crf2_34>=1500 && x.lw_crf2_36=1 && x.lw_crf2_37=1 && x.lw_crf2_38_a=2 && x.lw_crf2_38_b=2 && x.lw_crf2_39=2 && x.lw_crf2_40=1 && x.lw_crf2_41_a=2 && x.lw_crf2_41_b=2 && x.lw_crf2_41_c=2 && x.lw_crf2_41_d=2 && x.lw_crf2_41_e=2 && x.lw_crf2_41_f=2 &&  x.lw_crf2_42=2 && x.lw_crf2_43=2)	and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_7days_noExclusion, 				    (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and x.lw_crf2_26<168 and ( x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_47=2  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_47=1  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x where   (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Total_RandomFilled_3a", con);
                // before (15-Oct-2018)
                //   MySqlCommand cmd = new MySqlCommand("Select a.site as Site,   (SELECT count(*) FROM view_crf2 as x where a.site=x.site and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='7' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as LW_died,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_23='2' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q20='2' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q20='3' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Miscarriage,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q19!='1' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='3' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='2' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='5' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='6' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Adopted,               (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.Q17_Vstatus='4' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30!='' and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Complete,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30>=23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,             (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_and_Q26_Greater168,      			 (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (x.lw_crf2_32<32 or x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1) and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26>=168 and x.lw_crf2_44>=11 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_0to6_noExclusion,						   (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26<168 and (x.lw_crf2_32<32 or x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1) and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_noExclusion,	     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_47=2 and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where a.site=x.site and x.lw_crf2_47=1   and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x where a.site=x.site      and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as Total_RandomFilled_3a  from view_crf2 as  a  group by a.site   union all select 'Total',     (SELECT count(*) FROM view_crf2 as x where (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as TotalFilled_CRF2,     (SELECT count(*) FROM view_crf2 as x where  x.Q17_Vstatus='7'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as LW_died,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_23='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as NewBorn_died,        (SELECT count(*) FROM view_crf2 as x where x.Q20='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Stillbirth,        (SELECT count(*) FROM view_crf2 as x where x.Q20='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Miscarriage,        (SELECT count(*) FROM view_crf2 as x where x.Q19!='1'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Type_Pregnancy,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='3'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Refused,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='2'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Not_at_home,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='5'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Out_of_DSS,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='6'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))    ) as Adopted,        (SELECT count(*) FROM view_crf2 as x where x.Q17_Vstatus='4'  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as False_Preg,        (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30!=''  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as Complete,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30>=23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_GreaterEqual_23,        (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less_23,             (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and x.lw_crf2_26>=168  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_and_Q26_Greater168,    		(SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and x.lw_crf2_26>=168 and (x.lw_crf2_32<32 or x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26>=168 and x.lw_crf2_44>=11  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_Greater_0to6_noExclusion, 				    (SELECT count(*) FROM view_crf2 as x where  x.lw_crf2_30<23 and x.lw_crf2_26<168 and (x.lw_crf2_32<32 or x.lw_crf2_34<1500 or x.lw_crf2_36=2 or x.lw_crf2_37=2 or x.lw_crf2_38_a=1 or x.lw_crf2_38_b!=2 or x.lw_crf2_39=1 or x.lw_crf2_40=2 or x.lw_crf2_41_a=1 or x.lw_crf2_41_b=1 or x.lw_crf2_41_c=1 or x.lw_crf2_41_d=1 or x.lw_crf2_41_e=1 or x.lw_crf2_41_f!=2 or  x.lw_crf2_42=1 or x.lw_crf2_43=1)  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_and_AnyExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_30<23 and x.lw_crf2_26<168 and x.lw_crf2_44>=11  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as MUAC_Less23_Age_btw_0to6_noExclusion,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_47=2  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consent_refusedQ47,     (SELECT count(*) FROM view_crf2 as x where x.lw_crf2_47=1  and (str_to_date(x.date_of_attempt, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as consented_enrolledQ47,     (SELECT count(*) FROM view_crf3a as x where   (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as Total_RandomFilled_3a", con);                 
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView6.DataSource = dt;
                        GridView6.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }



        private void ExportArmReportDateWise()
        {
            //In CRF-2 Report, Add ARM with Date
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();

                MySqlCommand cmd = new MySqlCommand("select 'AG',(SELECT count(*) FROM view_crf3a as x where x.site='AG'  and   x.lw_crf_3a_19='a' and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_A',(SELECT count(*) FROM view_crf3a as x where x.site='AG'  and   x.lw_crf_3a_19='b' and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_B', (SELECT count(*) FROM view_crf3a as x where x.site='AG'  and   x.lw_crf_3a_19='c' and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_C' union all select 'BH',(SELECT count(*) FROM view_crf3a as x where x.site='BH'  and   x.lw_crf_3a_19='a' and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_A',(SELECT count(*) FROM view_crf3a as x where x.site='BH'  and   x.lw_crf_3a_19='b' and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_B', (SELECT count(*) FROM view_crf3a as x where x.site='BH'  and   x.lw_crf_3a_19='c' and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_C' union all select 'RG',(SELECT count(*) FROM view_crf3a as x where x.site='RG'  and   x.lw_crf_3a_19='a' and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_A',(SELECT count(*) FROM view_crf3a as x where x.site='RG'  and   x.lw_crf_3a_19='b' and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_B', (SELECT count(*) FROM view_crf3a as x where x.site='RG'  and   x.lw_crf_3a_19='c' and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_C' union all select 'Total',(SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='a' and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_A',(SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='b' and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_B', (SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='c' and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_C'", con);

                // Before 12-May-2019
                //MySqlCommand cmd = new MySqlCommand("select a.site as Site,(SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='a' and a.site=x.site and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_A',(SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='b' and a.site=x.site and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_B', (SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='c' and a.site=x.site and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_C'  from view_crf3a as a     group by a.site  union all select 'Total',(SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='a' and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_A',(SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='b' and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_B', (SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='c' and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') between str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y') and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')) ) as 'ARM_C'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView8.DataSource = dt;
                        GridView8.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }




        private void ExportArmReportWithoutDate()
        {
            //In CRF-2 Report, Add Cumulative ARM
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("select 'AG',(SELECT count(*) FROM view_crf3a as x where x.site='AG'  and  x.lw_crf_3a_19='a' and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_A',(SELECT count(*) FROM view_crf3a as x where x.site='AG'  and  x.lw_crf_3a_19='b' and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_B', (SELECT count(*) FROM view_crf3a as x where x.site='AG'  and  x.lw_crf_3a_19='c' and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_C' union all select 'BH',(SELECT count(*) FROM view_crf3a as x where x.site='BH'  and  x.lw_crf_3a_19='a' and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_A',(SELECT count(*) FROM view_crf3a as x where x.site='BH'  and  x.lw_crf_3a_19='b' and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_B', (SELECT count(*) FROM view_crf3a as x where x.site='BH'  and  x.lw_crf_3a_19='c' and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_C' union all select 'RG',(SELECT count(*) FROM view_crf3a as x where x.site='RG'  and  x.lw_crf_3a_19='a' and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_A',(SELECT count(*) FROM view_crf3a as x where x.site='RG'  and  x.lw_crf_3a_19='b' and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_B', (SELECT count(*) FROM view_crf3a as x where x.site='RG'  and  x.lw_crf_3a_19='c' and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_C' union all select 'Total',(SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='a' and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_A',(SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='b' and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_B', (SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='c' and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_C'", con);

                // Before 12-May-2019
                // MySqlCommand cmd = new MySqlCommand("select a.site as Site,(SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='a' and a.site=x.site and (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as 'ARM_A',(SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='b' and a.site=x.site and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))  ) as 'ARM_B', (SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='c' and a.site=x.site and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_C'  from view_crf3a as a     group by a.site  union all select 'Total',(SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='a' and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_A',(SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='b' and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_B', (SELECT count(*) FROM view_crf3a as x where  x.lw_crf_3a_19='c' and  (str_to_date(x.lw_crf_3a_2, '%d-%m-%Y') <= str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))   ) as 'ARM_C'", con);
                MySqlDataAdapter sda = new MySqlDataAdapter();
                {
                    cmd.Connection = con;
                    cmd.CommandTimeout = 0;
                    cmd.CommandType = CommandType.Text;
                    sda.SelectCommand = cmd;
                    DataTable dt = new DataTable();
                    {
                        sda.Fill(dt);
                        GridView9.DataSource = dt;
                        GridView9.DataBind();
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }




        //CRF-2  Report:
        public void ExcelExportReport()
        {
            try
            {
                Response.Clear();
                Response.AddHeader("content-disposition", "attachment;filename=CRF-2 Report (" + DateTime.Today.ToString("dd-MM-yyyy") + ").xls");
                Response.Charset = "";

                Response.ContentType = "application/vnd.xls";
                System.IO.StringWriter stringWrite = new System.IO.StringWriter();
                System.Web.UI.HtmlTextWriter htmlWrite =
                new HtmlTextWriter(stringWrite);
                GridView5.AllowPaging = false;
                GridView6.AllowPaging = false;
                GridView8.AllowPaging = false;
                GridView9.AllowPaging = false;
                ExcelExportMessage_Report();
                GridView5.CaptionAlign = TableCaptionAlign.Top;
                GridView6.CaptionAlign = TableCaptionAlign.Top;
                GridView8.CaptionAlign = TableCaptionAlign.Top;
                GridView9.CaptionAlign = TableCaptionAlign.Top;

                ExportReportdata();
                ExportReportdata_WithOutDate();
                ExportArmReportDateWise();
                ExportArmReportWithoutDate();

                for (int i = 0; i < GridView5.HeaderRow.Cells.Count; i++)
                {
                    GridView5.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView5.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView5.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView5.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView5.Rows[GridView5.Rows.Count - 1].Style.Add("font-size", "15px");
                GridView5.Rows[GridView5.Rows.Count - 1].Font.Bold = true;

                for (int i = 0; i < GridView6.HeaderRow.Cells.Count; i++)
                {
                    GridView6.HeaderRow.Cells[i].Style.Add("font-size", "15px");
                    GridView6.HeaderRow.Cells[i].Style.Add("height", "90px");
                    GridView6.HeaderRow.Cells[i].Style.Add("background-color", "#00B894");
                    GridView6.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView6.Rows[GridView6.Rows.Count - 1].Style.Add("font-size", "15px");
                GridView6.Rows[GridView6.Rows.Count - 1].Font.Bold = true;


                //ARM Report: 
                for (int i = 0; i < GridView8.HeaderRow.Cells.Count; i++)
                {
                    GridView8.HeaderRow.Cells[i].Style.Add("font-size", "16px");
                    GridView8.HeaderRow.Cells[i].Style.Add("height", "50px");
                    GridView8.HeaderRow.Cells[i].Style.Add("background-color", "#e17055");
                    GridView8.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView8.Rows[GridView8.Rows.Count - 1].Style.Add("font-size", "15px");
                GridView8.Rows[GridView8.Rows.Count - 1].Font.Bold = true;

                for (int i = 0; i < GridView9.HeaderRow.Cells.Count; i++)
                {
                    GridView9.HeaderRow.Cells[i].Style.Add("font-size", "16px");
                    GridView9.HeaderRow.Cells[i].Style.Add("height", "50px");
                    GridView9.HeaderRow.Cells[i].Style.Add("background-color", "#e17055");
                    GridView9.HeaderRow.Cells[i].Style.Add("Color", "white");
                }
                GridView9.Rows[GridView9.Rows.Count - 1].Style.Add("font-size", "15px");
                GridView9.Rows[GridView9.Rows.Count - 1].Font.Bold = true;


                GridView5.RenderControl(htmlWrite);
                GridView6.RenderControl(htmlWrite);
                GridView8.RenderControl(htmlWrite);
                GridView9.RenderControl(htmlWrite);

                Response.Write(stringWrite.ToString());
                Response.End();
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert(" + ex.Message + ")</script>");
            }
        }




        protected void OnRowDataBound(object sender, GridViewRowEventArgs e)
        {

            if (e.Row.RowType == DataControlRowType.DataRow)
            {
                //TAB NAME: 
                TableCell cell0 = e.Row.Cells[1];
                cell0.BackColor = System.Drawing.Color.FromName("#e0f0ff");

                //RED
                TableCell cell2 = e.Row.Cells[3];
                TableCell cell4 = e.Row.Cells[5];
                TableCell cell5 = e.Row.Cells[6];
                TableCell cell7 = e.Row.Cells[8];
                TableCell cell8 = e.Row.Cells[9];
                TableCell cell10 = e.Row.Cells[11];

                cell2.BackColor = System.Drawing.Color.FromName("#fff0f0");
                cell4.BackColor = System.Drawing.Color.FromName("#fff0f0");
                cell5.BackColor = System.Drawing.Color.FromName("#fff0f0");
                cell7.BackColor = System.Drawing.Color.FromName("#fff0f0");
                cell8.BackColor = System.Drawing.Color.FromName("#fff0f0");
                cell10.BackColor = System.Drawing.Color.FromName("#fff0f0");

                // GREEN   
                TableCell cell3 = e.Row.Cells[4];
                TableCell cell6 = e.Row.Cells[7];
                TableCell cell9 = e.Row.Cells[10];

                cell3.BackColor = System.Drawing.Color.FromName("#cef5cb");
                cell6.BackColor = System.Drawing.Color.FromName("#cef5cb");
                cell9.BackColor = System.Drawing.Color.FromName("#cef5cb");






                //if Text is 0 then will be chnage into GRAY

                if (e.Row.Cells[2].Text == "0")
                {
                    TableCell cell = e.Row.Cells[2];
                    cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
                }
                if (e.Row.Cells[3].Text == "0")
                {
                    TableCell cell = e.Row.Cells[3];
                    cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
                }
                if (e.Row.Cells[4].Text == "0")
                {
                    TableCell cell = e.Row.Cells[4];
                    cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
                }
                if (e.Row.Cells[5].Text == "0")
                {
                    TableCell cell = e.Row.Cells[5];
                    cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
                }
                if (e.Row.Cells[6].Text == "0")
                {
                    TableCell cell = e.Row.Cells[6];
                    cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
                }
                if (e.Row.Cells[7].Text == "0")
                {
                    TableCell cell = e.Row.Cells[7];
                    cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
                }
                if (e.Row.Cells[8].Text == "0")
                {
                    TableCell cell = e.Row.Cells[8];
                    cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
                }
                if (e.Row.Cells[9].Text == "0")
                {
                    TableCell cell = e.Row.Cells[9];
                    cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
                }
                if (e.Row.Cells[10].Text == "0")
                {
                    TableCell cell = e.Row.Cells[10];
                    cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
                }
                if (e.Row.Cells[11].Text == "0")
                {
                    TableCell cell = e.Row.Cells[11];
                    cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
                }
                if (e.Row.Cells[12].Text == "0")
                {
                    TableCell cell = e.Row.Cells[12];
                    cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
                }
            }
        }





        public void TotalEnrollment()
        {
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                MySqlCommand cmd = new MySqlCommand("select count(*) as total from form_crf_3a ", con);
                con.Open();
                MySqlDataReader dr = cmd.ExecuteReader();

                if (dr.Read() == true)
                {
                    lbeTotalEnrollment.Text = "Total: " + dr["total"].ToString();
                }
            }
            finally
            {
                con.Close();
            }
        }





        protected void OnRowDataBound1(object sender, GridViewRowEventArgs e)
        {
            if (e.Row.RowType == DataControlRowType.DataRow)
            {
                //TAB NAME: 
                TableCell cell0 = e.Row.Cells[0];
                cell0.BackColor = System.Drawing.Color.FromName("#e0f0ff");

                TableCell cell2 = e.Row.Cells[2];
                cell2.BackColor = System.Drawing.Color.FromName("#fff0f0");
            }



            //if Text is 0 then will be chnage into GRAY
            if (e.Row.Cells[1].Text == "0")
            {
                TableCell cell = e.Row.Cells[1];
                cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
            }
            if (e.Row.Cells[2].Text == "0")
            {
                TableCell cell = e.Row.Cells[2];
                cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
            }
            if (e.Row.Cells[3].Text == "0")
            {
                TableCell cell = e.Row.Cells[3];
                cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
            }
            if (e.Row.Cells[4].Text == "0")
            {
                TableCell cell = e.Row.Cells[4];
                cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
            }
            if (e.Row.Cells[5].Text == "0")
            {
                TableCell cell = e.Row.Cells[5];
                cell.ForeColor = System.Drawing.Color.FromName("#8395a7");
            }
        }


        //protected void Link_Button1(object sender, EventArgs e)
        //{

        //    if (((LinkButton)sender).CommandArgument != "Total")
        //    {
        //        //string UentryNme = ((LinkButton)sender).CommandArgument;
        //        //Session["RandTeamUname"] = UentryNme;
        //        //Session["FirstEDate"] = txtCalndrDate.Text;
        //        //Session["SecEDate"] = txtCalndrDate1.Text;
        //        //Response.Redirect("randUserdetails.aspx");
        //    }


        //}


    }
}